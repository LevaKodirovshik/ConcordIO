<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    <!-- OpenAPI client: Links OpenAPI contract to NSwag for code generation -->
    <Target Name="ConcordIOAddOpenApiReferenceForNSwag" 
            AfterTargets="ResolvePackageAssets"
            Condition="'@(ConcordIOContract)' != ''">
        <ItemGroup>
            <OpenApiReference Include="@(ConcordIOContract)" 
                              Condition="'%(ConcordIOContract.PackageId)' == 'Acme.PetStore.Contracts' And '%(ConcordIOContract.Kind)' == 'openapi'">
                <CodeGenerator>NSwagCSharp</CodeGenerator>
                <ClassName>PetStoreClient</ClassName>
                <OutputPath>PetStoreClient.cs</OutputPath>
                <NSwagJsonLibrary>SystemTextJson</NSwagJsonLibrary>
                <NSwagJsonPolymorphicSerializationStyle>SystemTextJson</NSwagJsonPolymorphicSerializationStyle>
                <NSwagGenerateExceptionClasses>true</NSwagGenerateExceptionClasses>
                <NSwagInjectHttpClient>true</NSwagInjectHttpClient>
            </OpenApiReference>
        </ItemGroup>
    </Target>
</Project>
